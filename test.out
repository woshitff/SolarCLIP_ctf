wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /home/home_node7/zyz/.netrc
wandb: Currently logged in as: chuyu666 (chuyu666-nankai-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[rank: 0] Seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

wandb: creating run
wandb: Tracking run with wandb version 0.19.7
wandb: Run data is saved locally in ./wandb/run-20250226_200625-4w6m6udj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run olive-universe-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/chuyu666-nankai-university/nankai_remote
wandb: üöÄ View run at https://wandb.ai/chuyu666-nankai-university/nankai_remote/runs/4w6m6udj
/home/home_node7/zyz/miniconda3/envs/ctf_test/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/home_node7/zyz/SolarCLIP_ctf/logs/reconmodels/autoencoder/vae/test_ldm/checkpoints exists and is not empty.
/home/home_node7/zyz/miniconda3/envs/ctf_test/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/home_node7/zyz/SolarCLIP_ctf/checkpoints exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name              | Type             | Params | Mode 
---------------------------------------------------------------
0 | model             | DiffusionWrapper | 96.0 M | train
1 | first_stage_model | CNN_VAE_two      | 1.7 M  | eval 
2 | cond_stage_model  | CNN_VAE_three    | 4.9 M  | eval 
3 | layernorm         | LayerNorm        | 64     | train
---------------------------------------------------------------
96.0 M    Trainable params
6.6 M     Non-trainable params
102 M     Total params
410.377   Total estimated model params size (MB)
223       Modules in train mode
708       Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
LDMWrapper: Running in eps-prediction mode
No module 'xformers'. Proceeding without it.
making attention of type 'vanilla' with 512 in_channels
DiffusionWrapper has 95.97 M params.
Working with z of shape (1, 8, 1, 1) = 8 dimensions.
Working with z of shape (1, 32, 1, 1) = 32 dimensions.
Working with z of shape (1, 8, 1, 1) = 8 dimensions.
Working with z of shape (1, 32, 1, 1) = 32 dimensions.
cond_stage_model not trainable
Setting learning rate to 1.00e-05
Setting learning optimizer to AdamW
Setting learning schedule to CosineAnnealingLR
#### Data #####
train, TestDataset, 10
validation, TestDataset, 10
Merged modelckpt-cfg: 
{'target': 'pytorch_lightning.callbacks.ModelCheckpoint', 'params': {'dirpath': 'logs/reconmodels/autoencoder/vae/test_ldm/checkpoints', 'filename': '{epoch:06}', 'verbose': True, 'save_last': False, 'save_top_k': -1, 'every_n_epochs': 20, 'save_weights_only': True}}
Caution: Saving checkpoints every n train steps without deleting. This might require some free space.
before trainer init {'accelerator': 'gpu', 'max_epochs': 5, 'devices': 'auto'}
Project config
model:
  base_learning_rate: 1.0e-05
  base_learning_optimizer: AdamW
  base_learning_schedule: CosineAnnealingLR
  target: models.reconmodels.ldm.models.diffusion.ddpm.LDMWrapper
  params:
    ckpt_path: null
    train_ldm: false
    parameterization: eps
    linear_start: 0.00085
    linear_end: 0.012
    log_every_t: 40
    timesteps: 300
    first_stage_key: '0094'
    cond_stage_key: '0094'
    spatial_size:
    - 32
    - 32
    channels: 32
    cond_stage_trainable: false
    conditioning_key: concat
    scale_factor: 128
    monitor: val/loss_simple_ema
    use_ema: false
    unet_config:
      target: models.reconmodels.ldm.modules.diffusionmodules.dpmmodels.model.Model
      params:
        ch: 128
        out_ch: 32
        ch_mult:
        - 1
        - 2
        - 4
        - 4
        num_res_blocks: 2
        attn_resolutions: []
        dropout: 0.0
        resamp_with_conv: true
        in_channels: 64
        resolution: 64
        use_timestep: true
        use_linear_attn: false
        attn_type: vanilla
    first_stage_config:
      target: models.reconmodels.autoencoder.models.vae.CNN_VAE_v2.CNN_VAE_two
      params:
        ckpt_path: null
        vae_modal: aia0094_image
        kl_weight: 0.1
        loss_type: MSE
        dd_config:
          double_z: true
          z_channels: 32
          resolution: 1024
          in_channels: 8
          out_ch: 8
          ch: 32
          ch_mult:
          - 1
          - 2
          - 2
          num_res_blocks: 2
          attn_resolutions: []
          dropout: 0.0
        first_stage_config:
          ckpt_path: null
          vae_modal: aia0094_image
          kl_weight: 0.1
          loss_type: MSE
          dd_config:
            double_z: true
            z_channels: 8
            resolution: 1024
            in_channels: 1
            out_ch: 1
            ch: 16
            ch_mult:
            - 1
            - 2
            - 2
            - 2
            num_res_blocks: 2
            attn_resolutions: []
            dropout: 0.0
    cond_stage_config:
      target: models.reconmodels.autoencoder.models.vae.CNN_VAE_v2.CNN_VAE_three
      params:
        dim: 1024
        vae_train: false
        vae_config:
          ckpt_path: null
          vae_modal: aia0094_image
          kl_weight: 0.1
          loss_type: MSE
          dd_config:
            double_z: true
            z_channels: 32
            resolution: 1024
            in_channels: 8
            out_ch: 8
            ch: 32
            ch_mult:
            - 1
            - 2
            - 2
            num_res_blocks: 2
            attn_resolutions: []
            dropout: 0.0
          first_stage_config:
            ckpt_path: null
            vae_modal: aia0094_image
            kl_weight: 0.1
            loss_type: MSE
            dd_config:
              double_z: true
              z_channels: 8
              resolution: 1024
              in_channels: 1
              out_ch: 1
              ch: 16
              ch_mult:
              - 1
              - 2
              - 2
              - 2
              num_res_blocks: 2
              attn_resolutions: []
              dropout: 0.0
data:
  target: data.build.DataModuleFromConfig
  params:
    batch_size: 1
    num_workers: 1
    wrap: false
    train:
      target: make_data.TestDataset
      params:
        modal_list:
        - '0094'
        - '0094'
        load_imgs: false
        enhance_list:
        - 1024
        - 0.5
        - 90
        time_interval:
        - 0
        - 4800
        time_step: 1
    validation:
      target: make_data.TestDataset
      params:
        modal_list:
        - '0094'
        - '0094'
        load_imgs: false
        enhance_list:
        - 1024
        - 0.5
        - 90
        time_interval:
        - 4800
        - 5265
        time_step: 1

Lightning config
trainer:
  accelerator: gpu
  max_epochs: 5
  devices: auto
callbacks:
  default_metrics_over_trainsteps_ckpt:
    target: pytorch_lightning.callbacks.ModelCheckpoint
    params:
      dirpath: ./checkpoints
      filename: LDM_009420094_best_val_loss_epoch
      verbose: true
      save_top_k: 1
      monitor: val/loss_simple_ema
      every_n_epochs: 1
      save_weights_only: true
  early_stop:
    target: pytorch_lightning.callbacks.EarlyStopping
    params:
      monitor: val/loss_simple_ema
      patience: 30
      verbose: true
      mode: min

Sanity Checking: |          | 0/? [00:00<?, ?it/s]/home/home_node7/zyz/miniconda3/envs/ctf_test/lib/python3.12/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=27` in the `DataLoader` to improve performance.
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]enter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:01, 43.46it/s][A
DDIM Sampler:  22%|‚ñà‚ñà‚ñè       | 11/50 [00:00<00:00, 52.16it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 56.05it/s][A
DDIM Sampler:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 25/50 [00:00<00:00, 57.76it/s][A
DDIM Sampler:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 32/50 [00:00<00:00, 59.41it/s][A
DDIM Sampler:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 39/50 [00:00<00:00, 60.90it/s][A
DDIM Sampler:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 46/50 [00:00<00:00, 61.76it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.17it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 63.09it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 63.26it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 63.61it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 62.72it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 63.20it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 63.41it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 63.58it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 63.29it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 62.77it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 63.10it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 63.14it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 63.03it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 63.09it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 63.05it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 63.05it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 62.96it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 62.68it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 62.65it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 62.72it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 62.75it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 61.89it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 62.16it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 62.07it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 62.15it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.
Sanity Checking DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:10<00:10,  0.10it/s]Sanity Checking DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:10<00:00,  0.19it/s]                                                                           /home/home_node7/zyz/miniconda3/envs/ctf_test/lib/python3.12/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=27` in the `DataLoader` to improve performance.
/home/home_node7/zyz/miniconda3/envs/ctf_test/lib/python3.12/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (10) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/10 [00:00<?, ?it/s] enter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 47.16it/s][A
DDIM Sampler:  22%|‚ñà‚ñà‚ñè       | 11/50 [00:00<00:00, 53.10it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 57.10it/s][A
DDIM Sampler:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 25/50 [00:00<00:00, 59.00it/s][A
DDIM Sampler:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 32/50 [00:00<00:00, 60.01it/s][A
DDIM Sampler:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 39/50 [00:00<00:00, 60.59it/s][A
DDIM Sampler:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 46/50 [00:00<00:00, 60.91it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.25it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.29it/s][A
DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.11it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.24it/s][A
DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.04it/s][A
DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 59.18it/s][A
DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 59.12it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.07it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 59.14it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.11it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 57.45it/s][A
DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 58.19it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 58.47it/s][A
DDIM Sampler:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 25/50 [00:00<00:00, 59.52it/s][A
DDIM Sampler:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 32/50 [00:00<00:00, 60.00it/s][A
DDIM Sampler:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 38/50 [00:00<00:00, 59.51it/s][A
DDIM Sampler:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 45/50 [00:00<00:00, 59.93it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.59it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.83it/s][A
DDIM Sampler:  26%|‚ñà‚ñà‚ñå       | 13/50 [00:00<00:00, 60.20it/s][A
DDIM Sampler:  40%|‚ñà‚ñà‚ñà‚ñà      | 20/50 [00:00<00:00, 60.48it/s][A
DDIM Sampler:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 27/50 [00:00<00:00, 60.78it/s][A
DDIM Sampler:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:00<00:00, 60.78it/s][A
DDIM Sampler:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 41/50 [00:00<00:00, 60.00it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 59.94it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.05it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.
Epoch 0:  10%|‚ñà         | 1/10 [00:10<01:34,  0.10it/s]Epoch 0:  10%|‚ñà         | 1/10 [00:10<01:34,  0.10it/s, v_num=6udj, train/loss_simple_step=1.140, train/loss_vlb_step=0.00881, train/loss_step=1.140, global_step=0.000]Epoch 0:  20%|‚ñà‚ñà        | 2/10 [00:10<00:42,  0.19it/s, v_num=6udj, train/loss_simple_step=1.140, train/loss_vlb_step=0.00881, train/loss_step=1.140, global_step=0.000]Epoch 0:  20%|‚ñà‚ñà        | 2/10 [00:10<00:42,  0.19it/s, v_num=6udj, train/loss_simple_step=1.120, train/loss_vlb_step=0.0134, train/loss_step=1.120, global_step=1.000] Epoch 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:25,  0.28it/s, v_num=6udj, train/loss_simple_step=1.120, train/loss_vlb_step=0.0134, train/loss_step=1.120, global_step=1.000]Epoch 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:25,  0.28it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00795, train/loss_step=1.110, global_step=2.000]Epoch 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:16,  0.36it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00795, train/loss_step=1.110, global_step=2.000]Epoch 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:16,  0.36it/s, v_num=6udj, train/loss_simple_step=1.120, train/loss_vlb_step=0.288, train/loss_step=1.120, global_step=3.000]  Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:11<00:11,  0.45it/s, v_num=6udj, train/loss_simple_step=1.120, train/loss_vlb_step=0.288, train/loss_step=1.120, global_step=3.000]Epoch 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:11<00:11,  0.45it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00781, train/loss_step=1.110, global_step=4.000]Epoch 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:11<00:07,  0.53it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00781, train/loss_step=1.110, global_step=4.000]Epoch 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:11<00:07,  0.53it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00773, train/loss_step=1.100, global_step=5.000]Epoch 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.61it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00773, train/loss_step=1.100, global_step=5.000]Epoch 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.61it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00858, train/loss_step=1.110, global_step=6.000]Epoch 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.68it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00858, train/loss_step=1.110, global_step=6.000]Epoch 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.68it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00995, train/loss_step=1.100, global_step=7.000]Epoch 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.76it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00995, train/loss_step=1.100, global_step=7.000]Epoch 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.76it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00777, train/loss_step=1.100, global_step=8.000]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:12<00:00,  0.83it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00777, train/loss_step=1.100, global_step=8.000]Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:12<00:00,  0.83it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00768, train/loss_step=1.090, global_step=9.000]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s][Aenter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 47.28it/s][A[A

DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 47.13it/s][A[A

DDIM Sampler:  32%|‚ñà‚ñà‚ñà‚ñè      | 16/50 [00:00<00:00, 49.40it/s][A[A

DDIM Sampler:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 23/50 [00:00<00:00, 53.96it/s][A[A

DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 56.77it/s][A[A

DDIM Sampler:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 37/50 [00:00<00:00, 58.47it/s][A[A

DDIM Sampler:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 44/50 [00:00<00:00, 59.30it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 56.54it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.86it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.85it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.75it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 61.75it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 61.69it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.34it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 61.10it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.30it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.80it/s][A[A

DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.89it/s][A[A

DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.93it/s][A[A

DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.94it/s][A[A

DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 59.90it/s][A[A

DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 59.51it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.22it/s][A[A

DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 59.41it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.48it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 60.75it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 60.54it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.49it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.52it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.44it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.41it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.41it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.37it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.

Validation DataLoader 0:  10%|‚ñà         | 1/10 [00:09<01:28,  0.10it/s][A
Validation DataLoader 0:  20%|‚ñà‚ñà        | 2/10 [00:09<00:39,  0.20it/s][A
Validation DataLoader 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:23,  0.30it/s][A
Validation DataLoader 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.39it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.48it/s][A
Validation DataLoader 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:06,  0.57it/s][A
Validation DataLoader 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:10<00:04,  0.66it/s][A
Validation DataLoader 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:10<00:02,  0.75it/s][A
Validation DataLoader 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:10<00:01,  0.83it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:10<00:00,  0.92it/s][A
                                                                        [AEpoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:23<00:00,  0.43it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00768, train/loss_step=1.090, global_step=9.000]Average Epoch time: 23.07 seconds
Average Peak memory 2568.14MiB
Average Reserved memory 3076.00MiB
Epoch 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:23<00:00,  0.43it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00768, train/loss_step=1.090, global_step=9.000, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Metric val/loss_simple_ema improved. New best score: 1.101
Epoch 0, global step 10: 'val/loss_simple_ema' reached 1.10133 (best 1.10133), saving model to '/home/home_node7/zyz/SolarCLIP_ctf/checkpoints/LDM_009420094_best_val_loss_epoch-v1.ckpt' as top 1
Epoch 0:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00768, train/loss_step=1.090, global_step=9.000, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]         Epoch 1:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00768, train/loss_step=1.090, global_step=9.000, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]enter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 48.65it/s][A
DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 48.50it/s][A
DDIM Sampler:  32%|‚ñà‚ñà‚ñà‚ñè      | 16/50 [00:00<00:00, 52.02it/s][A
DDIM Sampler:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 23/50 [00:00<00:00, 55.56it/s][A
DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 57.47it/s][A
DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 58.24it/s][A
DDIM Sampler:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 43/50 [00:00<00:00, 58.89it/s][A
DDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.47it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 57.03it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 60.08it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 60.19it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.35it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 59.87it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.04it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.16it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.20it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.13it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.62it/s][A
DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.48it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.68it/s][A
DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.38it/s][A
DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 59.11it/s][A
DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 59.30it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.29it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 59.44it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.39it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.88it/s][A
DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.92it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.79it/s][A
DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.73it/s][A
DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 59.51it/s][A
DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 59.44it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.60it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 59.71it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.63it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.
Epoch 1:  10%|‚ñà         | 1/10 [00:12<01:53,  0.08it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00768, train/loss_step=1.090, global_step=9.000, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  10%|‚ñà         | 1/10 [00:12<01:53,  0.08it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00773, train/loss_step=1.100, global_step=10.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  20%|‚ñà‚ñà        | 2/10 [00:12<00:50,  0.16it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00773, train/loss_step=1.100, global_step=10.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  20%|‚ñà‚ñà        | 2/10 [00:12<00:50,  0.16it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00826, train/loss_step=1.100, global_step=11.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:12<00:30,  0.23it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00826, train/loss_step=1.100, global_step=11.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:12<00:30,  0.23it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00984, train/loss_step=1.100, global_step=12.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:13<00:19,  0.31it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00984, train/loss_step=1.100, global_step=12.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:13<00:19,  0.31it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.0082, train/loss_step=1.100, global_step=13.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110] Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:13<00:13,  0.38it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.0082, train/loss_step=1.100, global_step=13.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:13<00:13,  0.38it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00771, train/loss_step=1.080, global_step=14.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:13<00:08,  0.45it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00771, train/loss_step=1.080, global_step=14.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:13<00:08,  0.45it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.0079, train/loss_step=1.110, global_step=15.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110] Epoch 1:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:13<00:05,  0.51it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.0079, train/loss_step=1.110, global_step=15.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:13<00:05,  0.51it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00809, train/loss_step=1.110, global_step=16.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:13<00:03,  0.58it/s, v_num=6udj, train/loss_simple_step=1.110, train/loss_vlb_step=0.00809, train/loss_step=1.110, global_step=16.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:13<00:03,  0.58it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00804, train/loss_step=1.100, global_step=17.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:13<00:01,  0.64it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00804, train/loss_step=1.100, global_step=17.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:13<00:01,  0.64it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00805, train/loss_step=1.080, global_step=18.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:14<00:00,  0.71it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00805, train/loss_step=1.080, global_step=18.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:14<00:00,  0.71it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0078, train/loss_step=1.090, global_step=19.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s][Aenter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 47.65it/s][A[A

DDIM Sampler:  22%|‚ñà‚ñà‚ñè       | 11/50 [00:00<00:00, 53.90it/s][A[A

DDIM Sampler:  34%|‚ñà‚ñà‚ñà‚ñç      | 17/50 [00:00<00:00, 56.27it/s][A[A

DDIM Sampler:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 23/50 [00:00<00:00, 57.63it/s][A[A

DDIM Sampler:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 29/50 [00:00<00:00, 58.35it/s][A[A

DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 59.81it/s][A[A

DDIM Sampler:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 43/50 [00:00<00:00, 60.28it/s][A[A

DDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.62it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 58.72it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.97it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 60.43it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.87it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.51it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.89it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.73it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.72it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.68it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 58.33it/s][A[A

DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 57.94it/s][A[A

DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 58.41it/s][A[A

DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 58.09it/s][A[A

DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 58.76it/s][A[A

DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 58.67it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.10it/s][A[A

DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 58.89it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 58.63it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 60.82it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 59.97it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.39it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.16it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.38it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.83it/s][A[A

DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 59.70it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.85it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.

Validation DataLoader 0:  10%|‚ñà         | 1/10 [00:10<01:31,  0.10it/s][A
Validation DataLoader 0:  20%|‚ñà‚ñà        | 2/10 [00:10<00:41,  0.19it/s][A
Validation DataLoader 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.29it/s][A
Validation DataLoader 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.38it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.47it/s][A
Validation DataLoader 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.56it/s][A
Validation DataLoader 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:10<00:04,  0.64it/s][A
Validation DataLoader 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.73it/s][A
Validation DataLoader 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.89it/s][A
                                                                        [AEpoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:25<00:00,  0.39it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0078, train/loss_step=1.090, global_step=19.00, train/loss_simple_epoch=1.110, train/loss_vlb_epoch=0.0367, train/loss_epoch=1.110]Average Epoch time: 25.52 seconds
Average Peak memory 2565.15MiB
Average Reserved memory 3076.00MiB
Epoch 1: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:25<00:00,  0.39it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0078, train/loss_step=1.090, global_step=19.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Metric val/loss_simple_ema improved by 0.015 >= min_delta = 0.0. New best score: 1.086
Epoch 1, global step 20: 'val/loss_simple_ema' reached 1.08621 (best 1.08621), saving model to '/home/home_node7/zyz/SolarCLIP_ctf/checkpoints/LDM_009420094_best_val_loss_epoch-v1.ckpt' as top 1
Epoch 1:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0078, train/loss_step=1.090, global_step=19.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]         Epoch 2:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0078, train/loss_step=1.090, global_step=19.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]enter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 48.58it/s][A
DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 48.53it/s][A
DDIM Sampler:  30%|‚ñà‚ñà‚ñà       | 15/50 [00:00<00:00, 48.38it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 49.80it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 54.05it/s][A
DDIM Sampler:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:00<00:00, 55.84it/s][A
DDIM Sampler:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 41/50 [00:00<00:00, 58.27it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 58.96it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 55.54it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.55it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 62.09it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.88it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 62.35it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 62.27it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 62.05it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 62.04it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.98it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.68it/s][A
DDIM Sampler:  26%|‚ñà‚ñà‚ñå       | 13/50 [00:00<00:00, 61.24it/s][A
DDIM Sampler:  40%|‚ñà‚ñà‚ñà‚ñà      | 20/50 [00:00<00:00, 61.22it/s][A
DDIM Sampler:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 27/50 [00:00<00:00, 61.40it/s][A
DDIM Sampler:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:00<00:00, 61.63it/s][A
DDIM Sampler:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 41/50 [00:00<00:00, 61.05it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 60.38it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.83it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 62.25it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 60.98it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.58it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.47it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.89it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.86it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.64it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.68it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.
Epoch 2:  10%|‚ñà         | 1/10 [00:10<01:30,  0.10it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0078, train/loss_step=1.090, global_step=19.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  10%|‚ñà         | 1/10 [00:10<01:30,  0.10it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00779, train/loss_step=1.100, global_step=20.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  20%|‚ñà‚ñà        | 2/10 [00:10<00:40,  0.20it/s, v_num=6udj, train/loss_simple_step=1.100, train/loss_vlb_step=0.00779, train/loss_step=1.100, global_step=20.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  20%|‚ñà‚ñà        | 2/10 [00:10<00:40,  0.20it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0115, train/loss_step=1.090, global_step=21.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100] Epoch 2:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.29it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0115, train/loss_step=1.090, global_step=21.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.29it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00774, train/loss_step=1.090, global_step=22.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.38it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00774, train/loss_step=1.090, global_step=22.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.38it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0079, train/loss_step=1.070, global_step=23.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100] Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.47it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0079, train/loss_step=1.070, global_step=23.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.47it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00884, train/loss_step=1.080, global_step=24.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.55it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00884, train/loss_step=1.080, global_step=24.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.55it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00986, train/loss_step=1.090, global_step=25.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.63it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00986, train/loss_step=1.090, global_step=25.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.63it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0138, train/loss_step=1.090, global_step=26.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100] Epoch 2:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.71it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0138, train/loss_step=1.090, global_step=26.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.71it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.0083, train/loss_step=1.080, global_step=27.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.79it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.0083, train/loss_step=1.080, global_step=27.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.79it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0161, train/loss_step=1.070, global_step=28.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.86it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0161, train/loss_step=1.070, global_step=28.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.86it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0131, train/loss_step=1.090, global_step=29.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s][Aenter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 48.37it/s][A[A

DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 48.47it/s][A[A

DDIM Sampler:  32%|‚ñà‚ñà‚ñà‚ñè      | 16/50 [00:00<00:00, 53.55it/s][A[A

DDIM Sampler:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 23/50 [00:00<00:00, 57.54it/s][A[A

DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 58.57it/s][A[A

DDIM Sampler:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 37/50 [00:00<00:00, 59.99it/s][A[A

DDIM Sampler:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 44/50 [00:00<00:00, 60.24it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 58.33it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.55it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.76it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.06it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 61.20it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 61.68it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.23it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 61.59it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.38it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.40it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.83it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.31it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 61.50it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 61.07it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.39it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 61.01it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.16it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 60.88it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.28it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.40it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.94it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.71it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.17it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.88it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.80it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.

Validation DataLoader 0:  10%|‚ñà         | 1/10 [00:09<01:29,  0.10it/s][A
Validation DataLoader 0:  20%|‚ñà‚ñà        | 2/10 [00:10<00:40,  0.20it/s][A
Validation DataLoader 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:23,  0.30it/s][A
Validation DataLoader 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.39it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.48it/s][A
Validation DataLoader 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.57it/s][A
Validation DataLoader 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:10<00:04,  0.66it/s][A
Validation DataLoader 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:10<00:02,  0.74it/s][A
Validation DataLoader 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:10<00:01,  0.83it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:10<00:00,  0.91it/s][A
                                                                        [AEpoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:22<00:00,  0.44it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0131, train/loss_step=1.090, global_step=29.00, train/loss_simple_epoch=1.100, train/loss_vlb_epoch=0.00816, train/loss_epoch=1.100]Average Epoch time: 22.74 seconds
Average Peak memory 2565.15MiB
Average Reserved memory 3076.00MiB
Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:22<00:00,  0.44it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0131, train/loss_step=1.090, global_step=29.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090] Metric val/loss_simple_ema improved by 0.002 >= min_delta = 0.0. New best score: 1.084
Epoch 2, global step 30: 'val/loss_simple_ema' reached 1.08430 (best 1.08430), saving model to '/home/home_node7/zyz/SolarCLIP_ctf/checkpoints/LDM_009420094_best_val_loss_epoch-v1.ckpt' as top 1
Epoch 2:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0131, train/loss_step=1.090, global_step=29.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]         Epoch 3:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0131, train/loss_step=1.090, global_step=29.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]enter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 48.15it/s][A
DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 48.15it/s][A
DDIM Sampler:  30%|‚ñà‚ñà‚ñà       | 15/50 [00:00<00:00, 48.08it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 49.74it/s][A
DDIM Sampler:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 27/50 [00:00<00:00, 53.18it/s][A
DDIM Sampler:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:00<00:00, 55.97it/s][A
DDIM Sampler:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 41/50 [00:00<00:00, 58.05it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 58.84it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 55.28it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 58.95it/s][A
DDIM Sampler:  26%|‚ñà‚ñà‚ñå       | 13/50 [00:00<00:00, 59.94it/s][A
DDIM Sampler:  40%|‚ñà‚ñà‚ñà‚ñà      | 20/50 [00:00<00:00, 60.40it/s][A
DDIM Sampler:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 27/50 [00:00<00:00, 61.28it/s][A
DDIM Sampler:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:00<00:00, 61.32it/s][A
DDIM Sampler:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 41/50 [00:00<00:00, 61.61it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 61.79it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.26it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.28it/s][A
DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.45it/s][A
DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.55it/s][A
DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.69it/s][A
DDIM Sampler:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 31/50 [00:00<00:00, 60.18it/s][A
DDIM Sampler:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 38/50 [00:00<00:00, 60.40it/s][A
DDIM Sampler:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 45/50 [00:00<00:00, 60.63it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.17it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 62.18it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 60.70it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.12it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.28it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.15it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.05it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.60it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.48it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.
Epoch 3:  10%|‚ñà         | 1/10 [00:10<01:32,  0.10it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.0131, train/loss_step=1.090, global_step=29.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  10%|‚ñà         | 1/10 [00:10<01:32,  0.10it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00757, train/loss_step=1.080, global_step=30.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  20%|‚ñà‚ñà        | 2/10 [00:10<00:41,  0.19it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00757, train/loss_step=1.080, global_step=30.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  20%|‚ñà‚ñà        | 2/10 [00:10<00:41,  0.19it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00795, train/loss_step=1.090, global_step=31.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.28it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00795, train/loss_step=1.090, global_step=31.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.28it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00925, train/loss_step=1.090, global_step=32.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:16,  0.37it/s, v_num=6udj, train/loss_simple_step=1.090, train/loss_vlb_step=0.00925, train/loss_step=1.090, global_step=32.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:16,  0.37it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.0322, train/loss_step=1.080, global_step=33.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090] Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:11<00:11,  0.45it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.0322, train/loss_step=1.080, global_step=33.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:11<00:11,  0.45it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00932, train/loss_step=1.080, global_step=34.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:11<00:07,  0.54it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00932, train/loss_step=1.080, global_step=34.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:11<00:07,  0.54it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00908, train/loss_step=1.080, global_step=35.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.62it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00908, train/loss_step=1.080, global_step=35.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.62it/s, v_num=6udj, train/loss_simple_step=1.060, train/loss_vlb_step=0.00745, train/loss_step=1.060, global_step=36.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.69it/s, v_num=6udj, train/loss_simple_step=1.060, train/loss_vlb_step=0.00745, train/loss_step=1.060, global_step=36.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.69it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00761, train/loss_step=1.080, global_step=37.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.77it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00761, train/loss_step=1.080, global_step=37.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.77it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00775, train/loss_step=1.080, global_step=38.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.84it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00775, train/loss_step=1.080, global_step=38.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.84it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00868, train/loss_step=1.070, global_step=39.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s][Aenter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 47.39it/s][A[A

DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 47.22it/s][A[A

DDIM Sampler:  30%|‚ñà‚ñà‚ñà       | 15/50 [00:00<00:00, 47.22it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 48.96it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 53.29it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 55.76it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 57.48it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 58.60it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 54.76it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 60.36it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.17it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.01it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 61.31it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.56it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.78it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.49it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.64it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.99it/s][A[A

DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.53it/s][A[A

DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.52it/s][A[A

DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.32it/s][A[A

DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 59.51it/s][A[A

DDIM Sampler:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 37/50 [00:00<00:00, 59.70it/s][A[A

DDIM Sampler:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 44/50 [00:00<00:00, 59.93it/s][A[A

DDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.75it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.65it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.93it/s][A[A

DDIM Sampler:  24%|‚ñà‚ñà‚ñç       | 12/50 [00:00<00:00, 59.65it/s][A[A

DDIM Sampler:  36%|‚ñà‚ñà‚ñà‚ñå      | 18/50 [00:00<00:00, 59.78it/s][A[A

DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 59.47it/s][A[A

DDIM Sampler:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 30/50 [00:00<00:00, 59.56it/s][A[A

DDIM Sampler:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 36/50 [00:00<00:00, 59.69it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.38it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 59.91it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 59.68it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.

Validation DataLoader 0:  10%|‚ñà         | 1/10 [00:10<01:31,  0.10it/s][A
Validation DataLoader 0:  20%|‚ñà‚ñà        | 2/10 [00:10<00:41,  0.19it/s][A
Validation DataLoader 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.29it/s][A
Validation DataLoader 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.38it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.47it/s][A
Validation DataLoader 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.56it/s][A
Validation DataLoader 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:10<00:04,  0.64it/s][A
Validation DataLoader 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:10<00:02,  0.73it/s][A
Validation DataLoader 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.81it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.89it/s][A
                                                                        [AEpoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:23<00:00,  0.43it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00868, train/loss_step=1.070, global_step=39.00, train/loss_simple_epoch=1.090, train/loss_vlb_epoch=0.0105, train/loss_epoch=1.090]Average Epoch time: 23.25 seconds
Average Peak memory 2565.15MiB
Average Reserved memory 3076.00MiB
Epoch 3: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:23<00:00,  0.43it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00868, train/loss_step=1.070, global_step=39.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Metric val/loss_simple_ema improved by 0.014 >= min_delta = 0.0. New best score: 1.070
Epoch 3, global step 40: 'val/loss_simple_ema' reached 1.06986 (best 1.06986), saving model to '/home/home_node7/zyz/SolarCLIP_ctf/checkpoints/LDM_009420094_best_val_loss_epoch-v1.ckpt' as top 1
Epoch 3:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00868, train/loss_step=1.070, global_step=39.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]         Epoch 4:   0%|          | 0/10 [00:00<?, ?it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00868, train/loss_step=1.070, global_step=39.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]enter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 48.19it/s][A
DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 48.25it/s][A
DDIM Sampler:  30%|‚ñà‚ñà‚ñà       | 15/50 [00:00<00:00, 48.23it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 51.28it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 55.19it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 57.81it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 59.07it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 59.79it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 56.24it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.98it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.01it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.94it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.67it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.79it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.14it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 61.49it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.14it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 60.92it/s][A
DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.24it/s][A
DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 61.54it/s][A
DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 61.43it/s][A
DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.92it/s][A
DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.78it/s][A
DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 60.63it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.83it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps

DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A
DDIM Sampler:  12%|‚ñà‚ñè        | 6/50 [00:00<00:00, 59.99it/s][A
DDIM Sampler:  26%|‚ñà‚ñà‚ñå       | 13/50 [00:00<00:00, 60.85it/s][A
DDIM Sampler:  40%|‚ñà‚ñà‚ñà‚ñà      | 20/50 [00:00<00:00, 60.52it/s][A
DDIM Sampler:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 27/50 [00:00<00:00, 60.65it/s][A
DDIM Sampler:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 34/50 [00:00<00:00, 61.04it/s][A
DDIM Sampler:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 41/50 [00:00<00:00, 61.13it/s][A
DDIM Sampler:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 48/50 [00:00<00:00, 61.14it/s][ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.85it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.
Epoch 4:  10%|‚ñà         | 1/10 [00:10<01:30,  0.10it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00868, train/loss_step=1.070, global_step=39.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  10%|‚ñà         | 1/10 [00:10<01:30,  0.10it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00812, train/loss_step=1.080, global_step=40.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  20%|‚ñà‚ñà        | 2/10 [00:10<00:40,  0.20it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.00812, train/loss_step=1.080, global_step=40.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  20%|‚ñà‚ñà        | 2/10 [00:10<00:40,  0.20it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0193, train/loss_step=1.070, global_step=41.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080] Epoch 4:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.29it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0193, train/loss_step=1.070, global_step=41.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:10<00:24,  0.29it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00776, train/loss_step=1.070, global_step=42.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.38it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00776, train/loss_step=1.070, global_step=42.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:10<00:15,  0.38it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0076, train/loss_step=1.070, global_step=43.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080] Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.47it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0076, train/loss_step=1.070, global_step=43.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:10<00:10,  0.47it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00923, train/loss_step=1.070, global_step=44.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.55it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00923, train/loss_step=1.070, global_step=44.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:10<00:07,  0.55it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0182, train/loss_step=1.070, global_step=45.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080] Epoch 4:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.63it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.0182, train/loss_step=1.070, global_step=45.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:11<00:04,  0.63it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00913, train/loss_step=1.070, global_step=46.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.71it/s, v_num=6udj, train/loss_simple_step=1.070, train/loss_vlb_step=0.00913, train/loss_step=1.070, global_step=46.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:11<00:02,  0.71it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.0176, train/loss_step=1.080, global_step=47.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080] Epoch 4:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.79it/s, v_num=6udj, train/loss_simple_step=1.080, train/loss_vlb_step=0.0176, train/loss_step=1.080, global_step=47.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:11<00:01,  0.79it/s, v_num=6udj, train/loss_simple_step=1.050, train/loss_vlb_step=0.0074, train/loss_step=1.050, global_step=48.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.86it/s, v_num=6udj, train/loss_simple_step=1.050, train/loss_vlb_step=0.0074, train/loss_step=1.050, global_step=48.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:11<00:00,  0.86it/s, v_num=6udj, train/loss_simple_step=1.050, train/loss_vlb_step=0.00779, train/loss_step=1.050, global_step=49.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/10 [00:00<?, ?it/s][Aenter if circle
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  10%|‚ñà         | 5/50 [00:00<00:00, 48.29it/s][A[A

DDIM Sampler:  20%|‚ñà‚ñà        | 10/50 [00:00<00:00, 48.16it/s][A[A

DDIM Sampler:  34%|‚ñà‚ñà‚ñà‚ñç      | 17/50 [00:00<00:00, 54.07it/s][A[A

DDIM Sampler:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 24/50 [00:00<00:00, 56.70it/s][A[A

DDIM Sampler:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 31/50 [00:00<00:00, 58.67it/s][A[A

DDIM Sampler:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 38/50 [00:00<00:00, 59.90it/s][A[A

DDIM Sampler:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 45/50 [00:00<00:00, 60.31it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 58.22it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.72it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.97it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 62.02it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 61.16it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 61.81it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.69it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 62.04it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.80it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.71it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.15it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.64it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.62it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 60.68it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 60.84it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 61.23it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 60.92it/s]
Data shape for DDIM sampling is (1, 32, 32, 32), eta 0.0
Running DDIM Sampling with 50 timesteps


DDIM Sampler:   0%|          | 0/50 [00:00<?, ?it/s][A[A

DDIM Sampler:  14%|‚ñà‚ñç        | 7/50 [00:00<00:00, 61.77it/s][A[A

DDIM Sampler:  28%|‚ñà‚ñà‚ñä       | 14/50 [00:00<00:00, 61.40it/s][A[A

DDIM Sampler:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 21/50 [00:00<00:00, 60.69it/s][A[A

DDIM Sampler:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 28/50 [00:00<00:00, 60.69it/s][A[A

DDIM Sampler:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 35/50 [00:00<00:00, 61.06it/s][A[A

DDIM Sampler:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 42/50 [00:00<00:00, 61.13it/s][A[A

DDIM Sampler:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 49/50 [00:00<00:00, 61.14it/s][A[ADDIM Sampler: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 50/50 [00:00<00:00, 61.00it/s]
Warning: No modal type provided for samples_x0_quantized. Skipping.
Warning: No modal type provided for samples_inpainting. Skipping.
Warning: No modal type provided for mask. Skipping.
Warning: No modal type provided for samples_outpainting. Skipping.

Validation DataLoader 0:  10%|‚ñà         | 1/10 [00:12<01:53,  0.08it/s][A
Validation DataLoader 0:  20%|‚ñà‚ñà        | 2/10 [00:12<00:51,  0.16it/s][A
Validation DataLoader 0:  30%|‚ñà‚ñà‚ñà       | 3/10 [00:12<00:30,  0.23it/s][A
Validation DataLoader 0:  40%|‚ñà‚ñà‚ñà‚ñà      | 4/10 [00:13<00:19,  0.31it/s][A
Validation DataLoader 0:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 5/10 [00:13<00:13,  0.38it/s][A
Validation DataLoader 0:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 6/10 [00:13<00:08,  0.45it/s][A
Validation DataLoader 0:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 7/10 [00:13<00:05,  0.52it/s][A
Validation DataLoader 0:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 8/10 [00:13<00:03,  0.59it/s][A
Validation DataLoader 0:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 9/10 [00:13<00:01,  0.66it/s][A
Validation DataLoader 0: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:13<00:00,  0.73it/s][A
                                                                        [AEpoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:25<00:00,  0.39it/s, v_num=6udj, train/loss_simple_step=1.050, train/loss_vlb_step=0.00779, train/loss_step=1.050, global_step=49.00, train/loss_simple_epoch=1.080, train/loss_vlb_epoch=0.0107, train/loss_epoch=1.080]Average Epoch time: 25.47 seconds
Average Peak memory 2565.15MiB
Average Reserved memory 3076.00MiB
Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:25<00:00,  0.39it/s, v_num=6udj, train/loss_simple_step=1.050, train/loss_vlb_step=0.00779, train/loss_step=1.050, global_step=49.00, train/loss_simple_epoch=1.070, train/loss_vlb_epoch=0.0112, train/loss_epoch=1.070]Metric val/loss_simple_ema improved by 0.005 >= min_delta = 0.0. New best score: 1.065
Epoch 4, global step 50: 'val/loss_simple_ema' reached 1.06516 (best 1.06516), saving model to '/home/home_node7/zyz/SolarCLIP_ctf/checkpoints/LDM_009420094_best_val_loss_epoch-v1.ckpt' as top 1
`Trainer.fit` stopped: `max_epochs=5` reached.
Epoch 4: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:42<00:00,  0.24it/s, v_num=6udj, train/loss_simple_step=1.050, train/loss_vlb_step=0.00779, train/loss_step=1.050, global_step=49.00, train/loss_simple_epoch=1.070, train/loss_vlb_epoch=0.0112, train/loss_epoch=1.070]
slurmstepd: error: *** JOB 34253 ON node8 CANCELLED AT 2025-02-26T20:11:44 ***
